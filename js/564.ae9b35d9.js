(self["webpackChunkhorario"]=self["webpackChunkhorario"]||[]).push([[564],{4140:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return $}});var i=s(7179),o=s(3058),r=s(5223),a=(s(7393),s(1012)),n=s(3316),l=s(911),d=l.Z.extend({name:"v-checkbox",props:{indeterminate:Boolean,indeterminateIcon:{type:String,default:"$checkboxIndeterminate"},offIcon:{type:String,default:"$checkboxOff"},onIcon:{type:String,default:"$checkboxOn"}},data(){return{inputIndeterminate:this.indeterminate}},computed:{classes(){return{...n.Z.options.computed.classes.call(this),"v-input--selection-controls":!0,"v-input--checkbox":!0,"v-input--indeterminate":this.inputIndeterminate}},computedIcon(){return this.inputIndeterminate?this.indeterminateIcon:this.isActive?this.onIcon:this.offIcon},validationState(){if(!this.isDisabled||this.inputIndeterminate)return this.hasError&&this.shouldValidate?"error":this.hasSuccess?"success":null!==this.hasColor?this.computedColor:void 0}},watch:{indeterminate(e){this.$nextTick((()=>this.inputIndeterminate=e))},inputIndeterminate(e){this.$emit("update:indeterminate",e)},isActive(){this.indeterminate&&(this.inputIndeterminate=!1)}},methods:{genCheckbox(){const{title:e,...t}=this.attrs$;return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.$createElement(a.Z,this.setTextColor(this.validationState,{props:{dense:this.dense,dark:this.dark,light:this.light}}),this.computedIcon),this.genInput("checkbox",{...t,"aria-checked":this.inputIndeterminate?"mixed":this.isActive.toString()}),this.genRipple(this.setTextColor(this.rippleState))])},genDefaultSlot(){return[this.genCheckbox(),this.genLabel()]}}}),u=s(4437),c=s(6035),h=s(9531),p=s(5452),g=s(6904),m=s(5057),f=s(5294),v=s(4544),x=s(5234),_=s(5251),b=s(1002),w=s(2370),R=function(){var e=this,t=e._self._c;return t(o.Z,{staticClass:"mx-auto mt-5"},[t(f.Z,[t(u.Z,{attrs:{cols:"6"}},[e.regionPositionsTableReady?t(h.Z,{ref:"leftTable",staticClass:"tabela",attrs:{headers:e.headersSalasTurnoSelecionado,items:e.regionPositions[e.turnoSelecionado][e.selectedTeacher],"disable-pagination":"","disable-filtering":"","disable-sort":"",dense:"","hide-default-footer":"","item-class":e.item_classes},scopedSlots:e._u([{key:"top",fn:function(){return[t(b.Z,{attrs:{flat:""}},[t(w.qW,[e._v(e._s(e.regionTitle))]),t(m.Z,{directives:[{name:"show",rawName:"v-show",value:null!=e.selectedRegion,expression:"selectedRegion != null"}],staticClass:"ml-1",on:{click:function(t){e.dialogClearRegion=!0}}},[e._v("mdi-delete")]),t(x.Z),t(u.Z,{attrs:{cols:"3"}},[null!=e.turnos&&e.turnos.length>1?t(v.Z,{attrs:{items:e.turnos,"item-text":"name","item-value":"id"},model:{value:e.turnoSelecionado,callback:function(t){e.turnoSelecionado=t},expression:"turnoSelecionado"}}):e._e()],1)],1)]},proxy:!0},{key:"item",fn:function(s){return[t("tr",[s.item.aula%e.aulasPorDiaTurnoSelecionado===0?t("td",{staticClass:"vertical-text",attrs:{rowspan:e.aulasPorDiaTurnoSelecionado}},[e._v(" "+e._s(e.diasSemana[Math.floor(s.item.aula/e.aulasPorDiaTurnoSelecionado)].name)+" ")]):e._e(),t("td",{style:{"border-bottom":s.item.aula%e.aulasPorDiaTurnoSelecionado===e.aulasPorDiaTurnoSelecionado-1?"1px solid black !important":null,"text-align":"center"}},[e._v(" "+e._s(s.item.aula%e.aulasPorDia+1)+" ")]),e._l(e.salasTurnoSelecionado,(function(i,o){return t("td",{key:o,style:{background:e.getColor(s.item[i.id]),backgroundOrigin:"border-box","border-bottom":s.item.aula%e.aulasPorDiaTurnoSelecionado===e.aulasPorDiaTurnoSelecionado-1?"1px solid black !important":null},on:{mousemove:function(t){return e.paintCell(t,s.item,i.id,s.index)},mousedown:function(t){return e.mouseDownHandler(t,s.index,i.id)},mouseup:function(t){return e.mouseUpHandler(t,s.index,i.id)},contextmenu:e.preventDefault}})}))],2)]}}],null,!1,2593860957)}):e._e()],1),t(u.Z,{attrs:{cols:"6"}},[t(h.Z,{attrs:{"disable-pagination":"","disable-filtering":"","disable-sort":"",dense:"","hide-default-footer":"",items:e.regions,headers:e.regionHeaders},scopedSlots:e._u([{key:"top",fn:function(){return[t(b.Z,{attrs:{flat:""}},[t(x.Z),t(p.Z,{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:o}){return[t(i.Z,e._g(e._b({staticClass:"mb-2",attrs:{color:"primary",dark:""}},"v-btn",o,!1),s),[e._v(" Nova região ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t(o.Z,[t(r.EB,[t("span",{staticClass:"text-h5"},[e._v(e._s(e.formTitle))])]),t(r.ZB,[t(c.Z,[t(g.Z,{ref:"regionForm",on:{submit:function(e){e.preventDefault()}}},[t(f.Z,[t(u.Z,{attrs:{cols:"12",sm:"6",md:"4"}},[t(v.Z,{attrs:{value:e.editedItem.id_professor,label:"Professor",items:e.professores,"item-text":"name","item-value":"id",rules:[e.rules.required]},on:{change:function(t){return e.changeTeacher(t,e.editedItem)}}})],1),t(u.Z,{attrs:{cols:"12",sm:"6",md:"4"}},[t(v.Z,{attrs:{label:"Regra",items:e.opcoesRegras,"item-text":"text","item-value":"id",rules:[e.rules.required]},model:{value:e.editedItem.regra,callback:function(t){e.$set(e.editedItem,"regra",t)},expression:"editedItem.regra"}})],1),t(u.Z,{attrs:{cols:"12",sm:"6",md:"4"}},[t(_.Z,{attrs:{number:"",label:"Número de aulas",rules:[e.rules.required,e.rules.greaterOrEqualThanZero]},model:{value:e.editedItem.num_aulas,callback:function(t){e.$set(e.editedItem,"num_aulas",t)},expression:"editedItem.num_aulas"}})],1)],1)],1)],1)],1),t(r.h7,[t(x.Z),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v(" Cancelar ")]),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.saveRegion}},[e._v(" OK ")])],1)],1)],1),t(p.Z,{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[t(o.Z,[t(r.EB,{staticClass:"text-h5"},[e._v("Deseja mesmo excluir essa região?")]),e.periodsWithSelectedRegion.size>1?t(r.ZB,[e._v(" Atenção: essa região tem posições em mais de um turno! ")]):e._e(),t(r.h7,[t(x.Z),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("Cancelar")]),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.deleteRegionConfirm}},[e._v("OK")]),t(x.Z)],1)],1)],1),t(p.Z,{attrs:{"max-width":"500px"},model:{value:e.dialogClearRegion,callback:function(t){e.dialogClearRegion=t},expression:"dialogClearRegion"}},[t(o.Z,[t(r.EB,{staticClass:"headline"},[e._v("Deseja mesmo limpar essa região?")]),e.periodsWithSelectedRegion.size>1?t(r.ZB,[e._v(" Atenção: essa região tem posições em mais de um turno! ")]):e._e(),t(r.h7,[t(x.Z),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDialogClearRegion}},[e._v("Cancelar")]),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.clearRegionPositions(e.selectedRegion)}}},[e._v("OK")]),t(x.Z)],1)],1)],1)],1)]},proxy:!0},{key:"item.regra",fn:function(t){return[e._v(" "+e._s(e.regrasLookup[t.item.regra])+" ")]}},{key:"item.id_professor",fn:function(t){return[e._v(" "+e._s(e.professoresLookup[t.item.id_professor])+" ")]}},{key:"item.dia",fn:function(s){return[t(d,{on:{change:e.changed},model:{value:s.item.movel,callback:function(t){e.$set(s.item,"movel",t)},expression:"props.item.movel"}})]}},{key:"item.actions",fn:function(s){return[t(m.Z,{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(s.item)}}},[e._v(" mdi-pencil ")]),t(m.Z,{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.deleteRegion(s.item)}}},[e._v(" mdi-delete ")]),t(m.Z,{staticClass:"mr-2",attrs:{small:"",color:s.item.id_regiao===e.selectedRegion||null!=s.item.id_regiao_temporario&&s.item.id_regiao_temporario===e.selectedRegion?"primary":null},on:{click:function(t){return e.viewItem(s.item)}}},[e._v(" mdi-eye ")])]}}],null,!0)}),t(c.Z,[t(b.Z,{attrs:{flat:""}},[t(w.qW,[e._v("Grupos de Alinhamento")]),t(x.Z),t(p.Z,{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:o}){return[t(i.Z,e._g(e._b({staticClass:"mb-2",attrs:{color:"primary",dark:""}},"v-btn",o,!1),s),[e._v(" Novo grupo ")])]}}]),model:{value:e.newGroupDialog,callback:function(t){e.newGroupDialog=t},expression:"newGroupDialog"}},[t(o.Z,[t(r.EB,[t("span",{staticClass:"text-h5"},[e._v("Novo grupo")])]),t(r.ZB,[t(c.Z,[t(g.Z,{ref:"groupForm",on:{submit:function(e){e.preventDefault()}}},[t(f.Z,[t(u.Z,{attrs:{cols:"6"}},[t(v.Z,{attrs:{label:"Sala 1","item-text":"name","item-value":"id",items:e.salasTurnoSelecionado,rules:[e.rules.required]},model:{value:e.editedItem.sala1,callback:function(t){e.$set(e.editedItem,"sala1",t)},expression:"editedItem.sala1"}})],1),t(u.Z,{attrs:{cols:"6"}},[t(v.Z,{attrs:{label:"Sala 2","item-text":"name","item-value":"id",items:e.salasTurnoSelecionado,rules:[e.rules.required]},model:{value:e.editedItem.sala2,callback:function(t){e.$set(e.editedItem,"sala2",t)},expression:"editedItem.sala2"}})],1)],1)],1)],1)],1),t(r.h7,[t(x.Z),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.closeNewGroupDialog}},[e._v(" Cancelar ")]),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.saveGroup}},[e._v(" OK ")])],1)],1)],1)],1),t("div",{key:e.gruposReload},e._l(e.grupos[e.turnoSelecionado],(function(s,a){return t(o.Z,{key:a,staticClass:"mt-5"},[t(r.EB,[t(x.Z),t(i.Z,{attrs:{color:"secondary"},on:{click:function(t){return e.deleteGroup(a)}}},[e._v(" Excluir ")])],1),t(f.Z,e._l(s.salas,(function(s,o){return t(u.Z,{key:`s-${o}`},[t(h.Z,{ref:"groupRowDatatable",refInFor:!0,attrs:{headers:e.groupHeaders,items:s.professores,"hide-default-footer":!0,"disable-pagination":"","disable-filtering":"","disable-sort":"",dense:""},scopedSlots:e._u([{key:"top",fn:function(){return[t(b.Z,{attrs:{flat:""}},[t(w.qW,[e._v(e._s(e.salasLookup[s.id])+" ")]),t(m.Z,{staticClass:"ml-1",on:{click:function(t){return e.editClass(a,o)}}},[e._v(" mdi-pencil ")]),t(x.Z),t(i.Z,{staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:function(t){return e.editGroupRow(a,o,-1)}}},[t(m.Z,[e._v(" mdi-plus ")])],1)],1)]},proxy:!0},{key:"item.actions",fn:function(s){return[t(m.Z,{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editGroupRow(a,o,s.index)}}},[e._v(" mdi-pencil ")]),t(m.Z,{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.deleteGroupRow(a,o,s.index)}}},[e._v(" mdi-delete ")])]}},{key:"item.professor",fn:function(t){return[e._v(" "+e._s(e.professoresLookup[t.item.professor])+" ")]}}],null,!0)})],1)})),1)],1)})),1),t(p.Z,{attrs:{"max-width":"500px"},model:{value:e.rowDialog,callback:function(t){e.rowDialog=t},expression:"rowDialog"}},[t(o.Z,[t(r.EB,[t("span",{staticClass:"text-h5"},[e._v(e._s(e.groupRowDialogTitle))])]),t(r.ZB,[t(c.Z,[t(g.Z,{ref:"groupRowForm",on:{submit:function(e){e.preventDefault()}}},[t(f.Z,[t(u.Z,{attrs:{cols:"12",sm:"6",md:"4"}},[t(v.Z,{attrs:{value:e.editedGroupRow.professor,label:"Professor",items:e.professores,"item-text":"name","item-value":"id",rules:[e.rules.required]},on:{change:e.handleGroupRowTeacherChange}})],1),t(u.Z,{attrs:{cols:"12",sm:"6",md:"4"}},[t(_.Z,{attrs:{number:"",label:"Número de aulas",rules:[e.rules.required,e.rules.greaterThanZero(!0)]},model:{value:e.editedGroupRow.aulas,callback:function(t){e.$set(e.editedGroupRow,"aulas",t)},expression:"editedGroupRow.aulas"}})],1)],1)],1)],1)],1),t(r.h7,[t(x.Z),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.closeGroupRow}},[e._v(" Cancelar ")]),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.saveGroupRow}},[e._v(" OK ")])],1)],1)],1),t(p.Z,{attrs:{"max-width":"600px"},model:{value:e.rowDialogDelete,callback:function(t){e.rowDialogDelete=t},expression:"rowDialogDelete"}},[t(o.Z,[t(r.EB,{staticClass:"text-h5"},[e._v("Deseja mesmo remover esse professor do grupo?")]),t(r.h7,[t(x.Z),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.closeGroupRowDelete}},[e._v("Cancelar")]),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.deleteGroupRowConfirm}},[e._v("OK")]),t(x.Z)],1)],1)],1),t(p.Z,{attrs:{"max-width":"600px"},model:{value:e.groupDialogDelete,callback:function(t){e.groupDialogDelete=t},expression:"groupDialogDelete"}},[t(o.Z,[t(r.EB,{staticClass:"text-h5"},[e._v("Deseja mesmo excluir esse grupo?")]),t(r.h7,[t(x.Z),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDeleteGroupDialog}},[e._v("Cancelar")]),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.deleteGroupConfirm}},[e._v("OK")]),t(x.Z)],1)],1)],1),t(p.Z,{attrs:{"max-width":"500px"},model:{value:e.editClassDialog,callback:function(t){e.editClassDialog=t},expression:"editClassDialog"}},[t(o.Z,[t(r.EB,[t("span",{staticClass:"text-h5"},[e._v("Selecionar sala")])]),t(r.ZB,[t(c.Z,[t(f.Z,[t(u.Z,[t(v.Z,{attrs:{label:"Sala","item-text":"name","item-value":"id",items:e.salas,rules:[e.rules.required]},model:{value:e.editedGroupClass,callback:function(t){e.editedGroupClass=t},expression:"editedGroupClass"}})],1)],1)],1)],1),t(r.h7,[t(x.Z),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.closeEditClassDialog}},[e._v(" Cancelar ")]),t(i.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.saveGroupClass}},[e._v(" OK ")])],1)],1)],1)],1)],1)],1)],1)},Z=[],C=(s(6314),s(6125)),D=s(4916),k=s(7632),S={name:"Especiais",props:["id"],mixins:[C.Z,D.Z],data:function(){return{regions:[],regionPositions:{},editedIndex:-1,selectedRegion:null,selectedTeacher:null,editedItem:{id_professor:null,num_aulas:0,regra:0,movel:0},defaultItem:{id_professor:null,num_aulas:0,regra:0,movel:0},dialog:!1,dialogDelete:!1,dialogClearRegion:!1,regionHeaders:[{text:"Professor",value:"id_professor"},{text:"Regra",value:"regra"},{text:"Aulas",value:"num_aulas"},{text:"Ações",value:"actions"}],rightMouseDown:0,leftMouseDown:0,startRow:null,startCol:null,endRow:null,endCol:null,lastSelection:[],deleteMode:!1,turnos:[],professores:[],salas:[],opcoesRegras:[{text:"Exatamente",id:0},{text:"No mínimo",id:1},{text:"No máximo",id:2}],professorAnterior:null,newGroupDialog:!1,editClassDialog:!1,groupHeaders:[{text:"Professor",value:"professor"},{text:"Aulas",value:"aulas"},{text:"Ações",value:"actions",sortable:!1,width:"30%"}],grupos:{},rowDialog:!1,rowDialogDelete:!1,editedGroupIndex:null,editedClass:null,editedRowIndex:null,editedGroupRow:{professor:null,aulas:0},defaultGroupRow:{professor:null,aulas:0},gruposReload:0,editedGroupClass:null,groupDialogDelete:!1}},mounted(){if(this.load(),this.$refs.leftTable){const e=this.$refs.leftTable.$children[0].$children[0].$el.children[1].children[0].children[2];e.addEventListener("mouseleave",(()=>{this.mouseUpHandler(),this.clearLastSelection()}))}},computed:{formTitle(){return-1===this.editedIndex?"Nova região":"Editar região"},groupRowDialogTitle(){return-1!==this.editedRowIndex?"Editar professor no grupo":"Adicionar professor ao grupo"},regionTitle(){if(null==this.selectedRegion)return"Regiões";const e=this.regions.find((e=>e.id_regiao===this.selectedRegion||null!=e.id_regiao_temporario&&e.id_regiao_temporario===this.selectedRegion));if(null==e||null==e.id_professor)return"Regiões";const t=this.professoresLookup[e.id_professor],s=this.opcoesRegras[e.regra].text,{num_aulas:i}=e;let o=`Região (${t} - ${s} ${i} aulas)`;return this.periodsWithSelectedRegion.size>1&&(o+=` (${this.periodsWithSelectedRegion.size} turnos)`),o},periodsWithSelectedRegion(){return this.getPeriodsWithRegion(this.selectedRegion)},regionPositionsTableReady(){return null!=this.selectedTeacher&&null!=this.turnoSelecionado&&null!=this.regionPositions[this.turnoSelecionado]&&null!=this.regionPositions[this.turnoSelecionado][this.selectedTeacher]},regrasLookup(){const e=Array.from(this.opcoesRegras,(e=>[e.id,e.text]));return Object.fromEntries(e)},aulasPorDia(){return this.turnos.find((e=>e.id===this.turnoSelecionado)).classes}},watch:{dialog(e){e||this.close(),!0===e&&this.resetValidation("regionForm")},dialogDelete(e){e||this.closeDelete()},dialogClearRegion(e){e||this.closeDialogClearRegion()},newGroupDialog(e){!0===e&&this.resetValidation("groupForm")},rowDialog(e){!0===e&&this.resetValidation("groupRowForm")}},methods:{changeTeacher(e,t){this.professorAnterior=t.id_professor,t.id_professor=e},mouseDownHandler(e,t,s){if(null==this.selectedRegion)return this.$toast.warning("Para definir as posições, selecione ou crie uma região");0===e.button?this.leftMouseDown=1:this.rightMouseDown=1,this.startRow=t,this.startCol=s},mouseUpHandler(e,t,s){this.leftMouseDown=0,this.rightMouseDown=0,this.endRow=t,this.endCol=s,this.lastSelection=[]},fillRegion(e,t,s,i){const o=Math.min(e,t),r=Math.max(e,t),a=Math.min(s,i),n=Math.max(s,i);this.clearLastSelection(),this.lastSelection=[];for(let l=o;l<=r;l++)for(let e=a;e<=n;e++)if(!this.regionPositions[this.turnoSelecionado][this.selectedTeacher][l][this.headersSalasTurnoSelecionado[e].value].includes(this.selectedRegion)&&this.leftMouseDown){const t=this.sortedIndex(this.regionPositions[this.turnoSelecionado][this.selectedTeacher][l][this.headersSalasTurnoSelecionado[e].value],this.selectedRegion);this.regionPositions[this.turnoSelecionado][this.selectedTeacher][l][this.headersSalasTurnoSelecionado[e].value].splice(t,0,this.selectedRegion),this.lastSelection.push([l,this.headersSalasTurnoSelecionado[e].value,this.regionPositions[this.turnoSelecionado][this.selectedTeacher][l][this.headersSalasTurnoSelecionado[e].value].filter((e=>e!==this.selectedRegion))])}else this.regionPositions[this.turnoSelecionado][this.selectedTeacher][l][this.headersSalasTurnoSelecionado[e].value].includes(this.selectedRegion)&&this.rightMouseDown&&(this.lastSelection.push([l,this.headersSalasTurnoSelecionado[e].value,this.regionPositions[this.turnoSelecionado][this.selectedTeacher][l][this.headersSalasTurnoSelecionado[e].value]]),this.removeItemOnce(this.regionPositions[this.turnoSelecionado][this.selectedTeacher][l][this.headersSalasTurnoSelecionado[e].value],this.selectedRegion))},removeItemOnce(e,t){var s=e.indexOf(t);s>-1&&e.splice(s,1)},sortedIndex(e,t){var s=0,i=e.length;while(s<i){var o=s+i>>>1;e[o]<t?s=o+1:i=o}return s},clearLastSelection(){this.lastSelection.forEach((e=>{this.regionPositions[this.turnoSelecionado][this.selectedTeacher][e[0]][e[1]]=e[2]||[]}))},editItem(e){this.editedIndex=this.regions.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteRegion(e){this.editedIndex=this.regions.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},clearRegionPositions(e){const t=this.getRegion(e);if(null==t)return;const{id_professor:s,id_regiao:i,id_regiao_temporario:o}=t;for(const r of this.turnos)if(null!=this.regionPositions[r.id])for(let e=0;e<this.numero_dias*r.classes;e++)for(const t of this.getClassesFromPeriod(r.id)){let a=this.regionPositions[r.id][s][e][t.id];const n=a.filter((e=>e!==i&&(null==o||e!==o)));this.regionPositions[r.id][s][e][t.id]=n}this.dialogClearRegion=!1},deleteRegionConfirm(){const{id_professor:e,id_regiao:t,id_regiao_temporario:s}=this.regions[this.editedIndex];if(this.clearRegionPositions(t||s),this.regions.splice(this.editedIndex,1),this.selectedRegion===t||null!=s&&this.selectedRegion===s){const t=this.regions.find((t=>t.id_professor===e));if(t)this.selectedRegion=t.id_regiao||t.id_regiao_temporario,this.selectedTeacher=t.id_professor;else if(this.regions.length>0){const e=this.regions[0];this.selectedRegion=e.id_regiao||e.id_regiao_temporario,this.selectedTeacher=e.id_professor}else this.selectedRegion=null}this.closeDelete()},close(){this.dialog=!1,this.$nextTick((()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1}))},closeDelete(){this.dialogDelete=!1,this.$nextTick((()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1}))},closeDialogClearRegion(){this.dialogClearRegion=!1},saveRegion(){if(this.validate("regionForm")){if(this.editedIndex>-1){this.checkChanges(this.regions[this.editedIndex],this.editedItem),Object.assign(this.regions[this.editedIndex],this.editedItem);const{id_professor:e}=this.editedItem;this.selectedTeacher=e}else this.changed(),this.editedItem.id_regiao_temporario=(0,k.Z)(),this.regions.push(this.editedItem),this.selectedRegion=this.editedItem.id_regiao_temporario,this.selectedTeacher=this.editedItem.id_professor;this.close()}},getClassIndex(e){return this.headersSalasTurnoSelecionado.findIndex((t=>t.value===e))},viewItem(e){this.selectedRegion=e.id_regiao||e.id_regiao_temporario,this.selectedTeacher=e.id_professor},closeNewGroupDialog(){this.newGroupDialog=!1,this.$nextTick((()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1}))},saveGroup(){if(this.validate("groupForm")){if(null==this.editedItem.sala1||null==this.editedItem.sala2)return this.$toast.error("É obrigatório configurar ambas as salas para criar o grupo de alinhamento");if(this.editedItem.sala1===this.editedItem.sala2)return this.$toast.error("O grupo de alinhamento deve relacionar salas diferentes");this.changed(),Object.hasOwn(this.grupos,this.turnoSelecionado)||(this.grupos[this.turnoSelecionado]=[]),this.grupos[this.turnoSelecionado].push({id:null,salas:[{id:this.editedItem.sala1,professores:[]},{id:this.editedItem.sala2,professores:[]}]}),this.closeNewGroupDialog()}},deleteGroup(e){this.editedGroupIndex=e,this.groupDialogDelete=!0},deleteGroupConfirm(){this.grupos[this.turnoSelecionado].splice(this.editedGroupIndex,1),this.closeDeleteGroupDialog(),this.changed(),this.$nextTick((()=>{this.editedGroupIndex=null}))},closeDeleteGroupDialog(){this.groupDialogDelete=!1},validateGroups(){let e=!0;for(const t in this.grupos)this.grupos[t].forEach((t=>{const s=[];t.salas.forEach((e=>{const t=e.professores.reduce(((e,t)=>e+Number(t.aulas)),0);s.push(t)}));const i=s.some((e=>e!==s[0]));i&&(e=!1)}));return e},validateNoEmptyGroups(){let e=!0;for(const t in this.grupos)this.grupos[t].forEach((t=>{t.salas.forEach((t=>{0===t.professores.length&&(e=!1)}))}));return e},async save(e=!0){if(!this.validateGroups())return void this.$toast.error("Cada sala do grupo de alinhamento deve ter a mesma quantidade de aulas a serem alinhadas");if(!this.validateNoEmptyGroups())return void this.$toast.error("Não é possível salvar um grupo sem professores inseridos");if(!this.validateMobileRegions())return void this.$toast.error("Regiões móveis devem estar contidas em um único dia de um único turno.");const t=await this.$axios.post("/especiais/",{regioes:this.regions,posicoesRegioes:this.regionPositions,gruposAlinhamento:this.grupos,id:this.id});200===t.status&&e&&this.load(!0)},async load(e=!1){try{this.setLoading(e),this.saved(),await this.getStructure();const t=await this.$axios.get("/especiais/"+this.id),{regioes:s,gruposAlinhamento:i,posicoesRegioes:o}=t.data;this.regions=s,this.grupos=i;const r={};for(const e of this.turnos){r[e.id]={};for(const t of this.professores){r[e.id][t.id]=[];for(let s=0;s<this.numero_dias*e.classes;s++){const i={aula:s};for(const t of this.getClassesFromPeriod(e.id))t.turno===e.id&&(i[t.id]=[]);r[e.id][t.id].push(i)}}}for(const e of o){const{id_regiao:t,id_sala:s,id_professor:i,aula:o}=e;for(const e of this.turnos)if(s in r[e.id][i][o]){const a=this.sortedIndex(r[e.id][i][o][s],t);r[e.id][i][o][s][a]=t}}const a={};for(const e of this.turnos)a[e.id]=[];for(const e of i){const t={salas:[]};for(const s of e.salas_grupo)t.salas.push({id:s,professores:[]});for(let s=0;s<e.professor.length;s++){const i=e.salas_grupo.findIndex((t=>t===e.sala[s]));-1!==i&&t.salas[i].professores.push({professor:e.professor[s],aulas:e.aula[s]})}a[e.id_turno].push(t)}this.grupos=a,this.regionPositions=r,0===this.regions.length?this.professores.length>0&&(this.selectedTeacher=this.professores[0].id):null!=this.selectedRegion&&null!=this.getRegion(this.selectedRegion)||(this.selectedRegion=this.regions[0].id_regiao,this.selectedTeacher=this.regions[0].id_professor)}catch(t){console.error(t)}finally{this.clearLoading()}},item_classes(e){if(e.aula%this.aulasPorDia==this.aulasPorDia-1&&e.aula!==this.aulasPorDia*this.numero_dias-1)return"ultima"},getRegion(e){return this.regions.find((t=>[t.id_regiao,t.id_regiao_temporario].includes(e)))},paintCell(e,t,s,i){if(null!=this.selectedRegion&&this.selectedTeacher===this.getRegion(this.selectedRegion).id_professor&&(this.leftMouseDown||this.rightMouseDown))return this.changed(),void this.fillRegion(this.startRow,i,this.getClassIndex(this.startCol),this.getClassIndex(s))},preventDefault(e){e.preventDefault()},getColor(e){const t="#03a9f4",s="#01579b";return 0===e.length?null:e.includes(this.selectedRegion)?t:s},getPeriodsWithRegion(e){const t=this.getRegion(e);if(null==t)return!1;const s=new Set;for(const i of this.turnos)for(const t of this.professores)if(null!=this.regionPositions[i.id])for(const o of this.regionPositions[i.id][t.id])for(const t of this.getClassesFromPeriod(i.id))o[t.id].includes(e)&&s.add(i.id);return s},validateMobileRegions(){const e={};for(const t of this.turnos)for(const s of this.professores)if(null!=this.regionPositions[t.id])for(const i of this.regionPositions[t.id][s.id])for(const s of this.getClassesFromPeriod(t.id))for(const o of i[s.id]){o in e||(e[o]=new Set);const s=Math.floor(i.aula/t.classes),r=t.id+"/"+s;e[o].add(r)}for(const t in e)if(e[t].size>1&&this.regions.find((e=>e.id_regiao===Number(t)||null!=e.id_regiao_temporario&&e.id_regiao_temporario===t)).movel)return!1;return!0},editGroupRow(e,t,s){this.editedGroupIndex=e,this.editedClass=t,this.editedRowIndex=s,this.rowDialog=!0,this.editedGroupRow=-1!==s?{...this.getGroupRowObject(this.turnoSelecionado,e,t,s)}:Object.assign({},this.defaultGroupRow)},deleteGroupRow(e,t,s){this.editedGroupIndex=e,this.editedClass=t,this.editedRowIndex=s,this.rowDialogDelete=!0},deleteGroupRowConfirm(){const e=this.grupos[this.turnoSelecionado][this.editedGroupIndex],t=e.salas[this.editedClass];t.professores.splice(this.editedRowIndex,1),this.closeGroupRowDelete(),this.changed()},closeGroupRow(){this.rowDialog=!1,this.$nextTick((()=>{this.editedGroupIndex=null,this.editedClass=null,this.editedRowIndex=null,this.editedGroupRow=Object.assign({},this.defaultGroupRow)}))},closeGroupRowDelete(){this.rowDialogDelete=!1},saveGroupRow(){if(!this.validate("groupRowForm"))return;const e=this.grupos[this.turnoSelecionado][this.editedGroupIndex],t=e.salas[this.editedClass],s=this.editedGroupRow.professor,i=t.professores.some(((e,t)=>e.professor===s&&t!==this.editedRowIndex));if(i)return this.$toast.error("Este professor já está alocado no grupo");-1!==this.editedRowIndex?(this.checkChanges(t.professores[this.editedRowIndex],this.editedGroupRow),t.professores[this.editedRowIndex]=Object.assign({},this.editedGroupRow)):(this.changed(),t.professores.push(Object.assign({},this.editedGroupRow))),this.closeGroupRow(),this.gruposReload+=1},getGroupRowObject(e,t,s,i){const o=this.grupos[e][t],r=o.salas[s],a=r.professores[i];return Object.assign({},a)},handleGroupRowTeacherChange(e){this.editedGroupRow.professor=e},editClass(e,t){this.editedGroupIndex=e,this.editedClass=t;const s=this.grupos[this.turnoSelecionado][e],i=s.salas[t];this.editedGroupClass=i.id,this.editClassDialog=!0},closeEditClassDialog(){this.editClassDialog=!1,this.$nextTick((()=>{this.editedGroupIndex=null,this.editedClass=null,this.editedGroupClass=null}))},saveGroupClass(){const e=this.grupos[this.turnoSelecionado][this.editedGroupIndex],t=this.editedGroupClass;if(e.salas.some(((e,s)=>e.id===t&&s!=this.editedClass)))return this.$toast.error("Esta sala já está alocada no grupo");this.checkChanges(s.id,this.editedGroupClass.valueOf());const s=e.salas[this.editedClass];s.id=this.editedGroupClass.valueOf(),this.gruposReload+=1,this.closeEditClassDialog()}}},I=S,y=s(3736),G=(0,y.Z)(I,R,Z,!1,null,"4cf9b59c",null),$=G.exports},6904:function(e,t,s){"use strict";var i=s(4987),o=s(4609),r=s(380);t["Z"]=(0,i.Z)(o.Z,(0,r.J)("form")).extend({name:"v-form",provide(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(e){const t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput(e){const t=e=>e.$watch("hasError",(t=>{this.$set(this.errorBag,e._uid,t)}),{immediate:!0}),s={_uid:e._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?s.shouldValidate=e.$watch("shouldValidate",(i=>{i&&(this.errorBag.hasOwnProperty(e._uid)||(s.valid=t(e)))})):s.valid=t(e),s},validate(){return 0===this.inputs.filter((e=>!e.validate(!0))).length},reset(){this.inputs.forEach((e=>e.reset())),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout((()=>{this.errorBag={}}),0)},resetValidation(){this.inputs.forEach((e=>e.resetValidation())),this.resetErrorBag()},register(e){this.inputs.push(e),this.watchers.push(this.watchInput(e))},unregister(e){const t=this.inputs.find((t=>t._uid===e._uid));if(!t)return;const s=this.watchers.find((e=>e._uid===t._uid));s&&(s.valid(),s.shouldValidate()),this.watchers=this.watchers.filter((e=>e._uid!==t._uid)),this.inputs=this.inputs.filter((e=>e._uid!==t._uid)),this.$delete(this.errorBag,t._uid)}},render(e){return e("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:e=>this.$emit("submit",e)}},this.$slots.default)}})},4437:function(e,t,s){"use strict";s(1884);var i=s(144),o=s(2653),r=s(1050);const a=["sm","md","lg","xl"],n=(()=>a.reduce(((e,t)=>(e[t]={type:[Boolean,String,Number],default:!1},e)),{}))(),l=(()=>a.reduce(((e,t)=>(e["offset"+(0,r.jC)(t)]={type:[String,Number],default:null},e)),{}))(),d=(()=>a.reduce(((e,t)=>(e["order"+(0,r.jC)(t)]={type:[String,Number],default:null},e)),{}))(),u={col:Object.keys(n),offset:Object.keys(l),order:Object.keys(d)};function c(e,t,s){let i=e;if(null!=s&&!1!==s){if(t){const s=t.replace(e,"");i+=`-${s}`}return"col"!==e||""!==s&&!0!==s?(i+=`-${s}`,i.toLowerCase()):i.toLowerCase()}}const h=new Map;t["Z"]=i.ZP.extend({name:"v-col",functional:!0,props:{cols:{type:[Boolean,String,Number],default:!1},...n,offset:{type:[String,Number],default:null},...l,order:{type:[String,Number],default:null},...d,alignSelf:{type:String,default:null,validator:e=>["auto","start","end","center","baseline","stretch"].includes(e)},tag:{type:String,default:"div"}},render(e,{props:t,data:s,children:i,parent:r}){let a="";for(const o in t)a+=String(t[o]);let n=h.get(a);if(!n){let e;for(e in n=[],u)u[e].forEach((s=>{const i=t[s],o=c(e,s,i);o&&n.push(o)}));const s=n.some((e=>e.startsWith("col-")));n.push({col:!s||!t.cols,[`col-${t.cols}`]:t.cols,[`offset-${t.offset}`]:t.offset,[`order-${t.order}`]:t.order,[`align-self-${t.alignSelf}`]:t.alignSelf}),h.set(a,n)}return e(t.tag,(0,o.ZP)(s,{class:n}),i)}})},5294:function(e,t,s){"use strict";s(1884);var i=s(144),o=s(2653),r=s(1050);const a=["sm","md","lg","xl"],n=["start","end","center"];function l(e,t){return a.reduce(((s,i)=>(s[e+(0,r.jC)(i)]=t(),s)),{})}const d=e=>[...n,"baseline","stretch"].includes(e),u=l("align",(()=>({type:String,default:null,validator:d}))),c=e=>[...n,"space-between","space-around"].includes(e),h=l("justify",(()=>({type:String,default:null,validator:c}))),p=e=>[...n,"space-between","space-around","stretch"].includes(e),g=l("alignContent",(()=>({type:String,default:null,validator:p}))),m={align:Object.keys(u),justify:Object.keys(h),alignContent:Object.keys(g)},f={align:"align",justify:"justify",alignContent:"align-content"};function v(e,t,s){let i=f[e];if(null!=s){if(t){const s=t.replace(e,"");i+=`-${s}`}return i+=`-${s}`,i.toLowerCase()}}const x=new Map;t["Z"]=i.ZP.extend({name:"v-row",functional:!0,props:{tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:d},...u,justify:{type:String,default:null,validator:c},...h,alignContent:{type:String,default:null,validator:p},...g},render(e,{props:t,data:s,children:i}){let r="";for(const o in t)r+=String(t[o]);let a=x.get(r);if(!a){let e;for(e in a=[],m)m[e].forEach((s=>{const i=t[s],o=v(e,s,i);o&&a.push(o)}));a.push({"no-gutters":t.noGutters,"row--dense":t.dense,[`align-${t.align}`]:t.align,[`justify-${t.justify}`]:t.justify,[`align-content-${t.alignContent}`]:t.alignContent}),x.set(r,a)}return e(t.tag,(0,o.ZP)(s,{staticClass:"row",class:a}),i)}})},1734:function(e,t,s){"use strict";var i=s(3176),o=s(144);t["Z"]=o.ZP.extend({name:"rippleable",directives:{ripple:i.Z},props:{ripple:{type:[Boolean,Object],default:!0}},methods:{genRipple(e={}){return this.ripple?(e.staticClass="v-input--selection-controls__ripple",e.directives=e.directives||[],e.directives.push({name:"ripple",value:{center:!0}}),this.$createElement("div",e)):null}}})},911:function(e,t,s){"use strict";s.d(t,{X:function(){return n}});var i=s(3316),o=s(1734),r=s(564),a=s(4987);function n(e){e.preventDefault()}t["Z"]=(0,a.Z)(i.Z,o.Z,r.Z).extend({name:"selectable",model:{prop:"inputValue",event:"change"},props:{id:String,inputValue:null,falseValue:null,trueValue:null,multiple:{type:Boolean,default:null},label:String},data(){return{hasColor:this.inputValue,lazyValue:this.inputValue}},computed:{computedColor(){if(this.isActive)return this.color?this.color:this.isDark&&!this.appIsDark?"white":"primary"},isMultiple(){return!0===this.multiple||null===this.multiple&&Array.isArray(this.internalValue)},isActive(){const e=this.value,t=this.internalValue;return this.isMultiple?!!Array.isArray(t)&&t.some((t=>this.valueComparator(t,e))):void 0===this.trueValue||void 0===this.falseValue?e?this.valueComparator(e,t):Boolean(t):this.valueComparator(t,this.trueValue)},isDirty(){return this.isActive},rippleState(){return this.isDisabled||this.validationState?this.validationState:void 0}},watch:{inputValue(e){this.lazyValue=e,this.hasColor=e}},methods:{genLabel(){const e=i.Z.options.methods.genLabel.call(this);return e?(e.data.on={click:n},e):e},genInput(e,t){return this.$createElement("input",{attrs:Object.assign({"aria-checked":this.isActive.toString(),disabled:this.isDisabled,id:this.computedId,role:e,type:e},t),domProps:{value:this.value,checked:this.isActive},on:{blur:this.onBlur,change:this.onChange,focus:this.onFocus,keydown:this.onKeydown,click:n},ref:"input"})},onClick(e){this.onChange(),this.$emit("click",e)},onChange(){if(!this.isInteractive)return;const e=this.value;let t=this.internalValue;if(this.isMultiple){Array.isArray(t)||(t=[]);const s=t.length;t=t.filter((t=>!this.valueComparator(t,e))),t.length===s&&t.push(e)}else t=void 0!==this.trueValue&&void 0!==this.falseValue?this.valueComparator(t,this.trueValue)?this.falseValue:this.trueValue:e?this.valueComparator(t,e)?null:e:!t;this.validate(!0,t),this.internalValue=t,this.hasColor=t},onFocus(e){this.isFocused=!0,this.$emit("focus",e)},onBlur(e){this.isFocused=!1,this.$emit("blur",e)},onKeydown(e){}}})},4916:function(e,t){"use strict";function s(e){return null==e||0===String(e).trim().length}t["Z"]={data(){return{rules:{required:e=>null!=e&&String(e).trim().length>0||"Obrigatório",greaterThanZero:e=>t=>s(t)?!0!==e||"Deve ser um número maior que zero":/^[1-9]\d*$/.test(t)||"Deve ser um número maior que zero",greaterOrEqualThanZero:e=>{if(null==e)return"Deve ser um número maior ou igual a zero";const t=parseInt(e,10);return Number.isInteger(t)&&t>=0||"Deve ser um número maior ou igual a zero"},lessThanOrEqual:(e,t)=>i=>{if(s(i))return!0!==t||"Deve ser um número menor ou igual a "+e;const o=parseInt(i,10);return Number.isInteger(o)&&o<=e||"Deve ser um número menor ou igual a "+e}}}},methods:{resetValidation(e){null!=e&&null!=this.$refs[e]?this.$refs[e].resetValidation():null!=this.$refs.form&&this.$refs.form.resetValidation()},validate(e){return null!=e&&null!=this.$refs[e]?this.$refs[e].validate():null!=this.$refs.form?this.$refs.form.validate():void 0}}}},6314:function(e,t,s){var i=s(2109),o=s(2597);i({target:"Object",stat:!0},{hasOwn:o})},7393:function(){},7632:function(e,t,s){"use strict";s.d(t,{Z:function(){return c}});const i="undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var o={randomUUID:i};let r;const a=new Uint8Array(16);function n(){if(!r&&(r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(a)}const l=[];for(let h=0;h<256;++h)l.push((h+256).toString(16).slice(1));function d(e,t=0){return(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase()}function u(e,t,s){if(o.randomUUID&&!t&&!e)return o.randomUUID();e=e||{};const i=e.random||(e.rng||n)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){s=s||0;for(let e=0;e<16;++e)t[s+e]=i[e];return t}return d(i)}var c=u}}]);
//# sourceMappingURL=564.ae9b35d9.js.map